module.exports.config = {
  name: "leavenoti",
  eventType: ["log:unsubscribe"],
  version: "1.0.1",
  credits: "Rakib Boss",
  description: "Custom leave message with proper user name"
};

module.exports.run = async ({ event, api }) => {
  const moment = require("moment-timezone");
  const time = moment().tz("Asia/Dhaka").format("DD/MM/YYYY || HH:mm:ss");

  const threadInfo = await api.getThreadInfo(event.threadID);
  const groupName = threadInfo.threadName;

  let name = "ржХрж┐ржХ ржжрзЗржУрзЯрж╛ рж╕ржжрж╕рзНржп";
  try {
    const info = await api.getUserInfo(event.leftParticipantFbId);
    name = info[event.leftParticipantFbId].name || name;
  } catch (e) {
    console.log("тЭМ ржЗржЙржЬрж╛рж░ ржирж╛ржо ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐:", e);
  }

  const msg = `тАОтХнтАвтФДтФЕтХРтХРтЭБЁЯС╣тЭБтХРтХРтФЕтФДтАвтХо
тЭБтХРЁЯМ╗${groupName}ЁЯМ╗тХРтЭБ
тХ░тАвтФДтФЕтХРтХРтЭБЁЯС╣тЭБтХРтХРтФЕтФДтАвтХп

тЪЬя╕П ${name} тЪЬя╕П

тЧПтЦмр╣С█й ржмржЙржд ржмржирзНржбрж╛ржорж┐ ржХрж░рж┐рзЯрж╛ ржерж╛ржХржЫрзЛ, ржЖрж░ ржерж╛ржХрж╛рж░ ржжрж░ржХрж╛рж░ ржирж╛рзЯтЬитЬи 

ЁЯСЙЁЯП╗┬а┬а${name}┬а┬аЁЯСИЁЯП╗
тШЭя╕ПЁЯж╡рж╕рзЯрждрж╛ржирж░рзЗ рж▓рж╛рждрзНрждрж┐ ржжрж┐рзЯрж╛ ржмрж╛рж░ ржХрж░ ЁЯж╡ЁЯЦХ

тЧПтЦмр╣С█й рждрзБржорж░рж╛рж░ ржЬрж╛ржирж╛ ржорждрзЗ ржЗржЧрзБ ржнрж╛рж▓рж╛ ржирж╛ ржмрж╛ржж ржЖржЫрж┐рж▓, ржХржЗрзЯрж╛ ржЬрж╛ржЙЁЯдФЁЯдФ


тАОтХнтАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХо
ЁЯМ╣-Made by RAKIB-ЁЯМ╣
тХ░тАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХп

тЭБтХРтЭБЁЯМ╗AR BOTЁЯМ╗тЭБтХРтЭБ
ЁЯШе...Good Byee || ${time}`;

  return api.sendMessage(msg, event.threadID);
};
