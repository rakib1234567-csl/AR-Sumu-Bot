// File: aiazan.js
const axios = require("axios");
const schedule = require("node-schedule");

module.exports.config = {
  name: "aiazan",
  version: "1.0.0",
  role: 0,
  credits: "Rakib Boss",
  description: "Auto namaz message sender",
  hasPrefix: false,
  usages: "auto namaz",
  cooldowns: 5,
};

module.exports.run = async ({ api, event }) => {
  const threadID = "9902688179785851"; // Rakib Boss group ID

  const waqtMessages = {
    fajr: `
тХнтАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХо
тАв┬╗тЬи"ржлржЬрж░"-ржПрж░ ржЖржЬрж╛ржитЬи┬лтАв
тХ░тАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХп

ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!
ржнрзЛрж░рзЗрж░ ржЖрж▓рзЛ ржЙржарзЗржЫрзЗ, ржПржмрж╛рж░ "ржлржЬрж░" ржПрж░ ржирж╛ржорж╛ржЬрзЗ ржЪрж▓рзБржи ржнрж╛ржЗ ржУ ржмржЗржи ржЕржХрж▓ред

ржЕржирзБрж░рзЛржзрзЗ -
AR Sumu Bot & RAKIB BOSS
`,

    dhuhr: `
тХнтАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХо
тАв┬╗тЬи"ржпрзЛрж╣рж░"-ржПрж░ ржЖржЬрж╛ржитЬи┬лтАв
тХ░тАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХп

ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!
ржжрж┐ржирзЗрж░ ржорж╛ржЭржЦрж╛ржирзЗ рж╢рж╛ржирзНрждрж┐рж░ ржирж╛ржорж╛ржЬ - "ржпрзЛрж╣рж░" рж╢рзБрж░рзБ рж╣ржЗржЫрзЗ, рж╕ржмрж╛ржЗ ржирж╛ржорж╛ржЬрзЗ ржЪрж▓рзБржиред

ржЕржирзБрж░рзЛржзрзЗ -
AR Sumu Bot & RAKIB BOSS
`,

    asr: `
тХнтАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХо
тАв┬╗тЬи"ржЖрж╕рж░"-ржПрж░ ржЖржЬрж╛ржитЬи┬лтАв
тХ░тАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХп

ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!
ржмрж┐ржХрзЗрж▓рзЗрж░ ржЖрж▓рзЛрждрзЗ ржЖрж╕рж░рзЗрж░ ржЖржЬрж╛ржи рж╣ржЗржЫрзЗ, рж╕ржмрж╛ржЗ ржирж╛ржорж╛ржЬрзЗ ржпрж╛ржмрж╛рж░ ржкрзНрж░рж╕рзНрждрзБрждрж┐ ржирж┐ржиред

ржЕржирзБрж░рзЛржзрзЗ -
AR Sumu Bot & RAKIB BOSS
`,

    maghrib: `
тХнтАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХо
тАв┬╗тЬи"ржорж╛ржЧрж░рж┐ржм"-ржПрж░ ржЖржЬрж╛ржитЬи┬лтАв
тХ░тАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХп

ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!ЁЯЦд
рж╕рзВрж░рзНржп ржЕрж╕рзНржд ржпрж╛ржЪрзНржЫрзЗ, "ржорж╛ржЧрж░рж┐ржм" ржПрж░ рж╕ржорзЯ рж╣рзЯрзЗ ржЧрзЗржЫрзЗ тАФ рж╕ржмрж╛ржЗ ржирж╛ржорж╛ржЬрзЗ ржЪрж▓рзБржиред

ржЕржирзБрж░рзЛржзрзЗ -
AR Sumu Bot & RAKIB BOSS
`,

    isha: `
тХнтАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХо
тАв┬╗тЬи"ржПрж╢рж╛"-ржПрж░ ржЖржЬрж╛ржитЬи┬лтАв
тХ░тАвтФДтФЕтХРтХРтЭБЁЯМ║тЭБтХРтХРтФЕтФДтАвтХп

ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!
рж░рж╛рждрзЗрж░ ржирзАрж░ржмрждрж╛рзЯ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржбрж╛ржХрзЗ рж╕рж╛рзЬрж╛ ржжрж┐ржи, ржПрж╢рж╛рж░ ржирж╛ржорж╛ржЬ ржкрзЬрж┐ рж╕ржмрж╛ржЗред

ржЕржирзБрж░рзЛржзрзЗ -
AR Sumu Bot & RAKIB BOSS
`,
  };

  async function getPrayerTimes() {
    const res = await axios.get(
      "https://api.aladhan.com/v1/timingsByCity?city=Sylhet&country=Bangladesh&method=2"
    );
    return res.data.data.timings;
  }

  async function scheduleNamaz() {
    const timings = await getPrayerTimes();

    const waqtList = {
      fajr: timings.Fajr,
      dhuhr: timings.Dhuhr,
      asr: timings.Asr,
      maghrib: timings.Maghrib,
      isha: timings.Isha,
    };

    for (const waqt in waqtList) {
      const [hour, min] = waqtList[waqt].split(":").map(Number);

      schedule.scheduleJob({ hour, minute: min, tz: "Asia/Dhaka" }, () => {
        const msg = waqtMessages[waqt];
        api.sendMessage(msg, threadID, (err) => {
          if (err) console.error(`тЭМ ${waqt} ржорзЗрж╕рзЗржЬ ржкрж╛ржарж╛рждрзЗ рж╕ржорж╕рзНржпрж╛:`, err);
          else console.log(`тЬЕ ${waqt} ржЖржЬрж╛ржи ржорзЗрж╕рзЗржЬ ржкрж╛ржарж╛ржирзЛ рж╣рзЯрзЗржЫрзЗ`);
        });
      });
    }

    api.sendMessage("тЬЕ ржЖржЬрж╛ржи ржЕржЯрзЛ ржорзЗрж╕рзЗржЬ ржЪрж╛рж▓рзБ рж╣рзЯрзЗржЫрзЗ! (Sylhet ржЕржирзБржпрж╛рзЯрзА)", threadID);
  }

  scheduleNamaz();
};
